python codegen_sources/model/train.py \
--exp_name mlm \
--dump_path '/home/carl/CodeGen/output' \
--data_path '/home/carl/CodeGen/data/anghabench3/cpp/XLM-syml' \
--split_data_accross_gpu local \
--mlm_steps 'cpp' \
--add_eof_to_stream true \
--word_mask_keep_rand '0.8,0.1,0.1' \
--word_pred '0.15' \
--encoder_only true \
--n_layers 12  \
--emb_dim 768  \
--n_heads 12  \
--lgs 'cpp' \
--max_vocab 64000 \
--gelu_activation true \
--roberta_mode false \
--amp 0  \
--fp16 false  \
--batch_size 32 \
--bptt 256 \
--epoch_size 100000 \
--max_epoch 1000 \
--split_data_accross_gpu global \
--optimizer 'adam_inverse_sqrt,warmup_updates=10000,lr=0.0001,weight_decay=0.01' \
--save_periodic 0 \
--validation_metrics _valid_mlm_ppl \
--stopping_criterion '_valid_mlm_ppl,10' 